<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Sistema de anÃ¡lisis de video e imÃ¡genes usando agentes de IA con LangGraph para investigaciÃ³n OSINT">
    <meta name="keywords" content="OSINT, anÃ¡lisis de video, IA, LangGraph, visiÃ³n por computadora, OCR, detecciÃ³n de objetos">
    <meta name="theme-color" content="#1a1a2e">
    <meta name="robots" content="noindex, nofollow">
    <title>WatchDogs - Video Analysis System</title>
    <link rel="stylesheet" href="static/css/style.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header role="banner">
            <h1>ğŸ¯ WatchDogs OSINT - Video Analysis System</h1>
            <p class="subtitle">Sistema de Agentes Multi-Modal para AnÃ¡lisis de Video e ImÃ¡genes</p>
            <div id="connectionStatus" class="connection-status" role="status" aria-live="polite"></div>
        </header>

        <!-- Video Upload Section -->
        <section class="upload-section" role="region" aria-labelledby="upload-heading">
            <h2 id="upload-heading">ğŸ“¤ 1. Cargar Video</h2>
            <div class="upload-area">
                <input type="file" id="videoInput" accept="video/*" aria-label="Seleccionar archivo de video" hidden>
                <button id="uploadBtn" class="btn btn-primary" aria-describedby="uploadStatus">Seleccionar Video</button>
                <p id="uploadStatus" class="status-text" role="status" aria-live="polite"></p>
            </div>
        </section>

        <!-- Video Player Section -->
        <section class="player-section" id="playerSection" style="display: none;">
            <h2>ğŸ¬ 2. Reproducir y Seleccionar Frame</h2>
            
            <div class="video-container">
                <video id="videoPlayer" controls></video>
                <canvas id="roiCanvas"></canvas>
            </div>

            <div class="controls">
                <button id="playPauseBtn" class="btn btn-control">â–¶ï¸ Play</button>
                <button id="captureBtn" class="btn btn-primary" disabled>ğŸ“¸ Capturar Frame</button>
                <button id="clearRoiBtn" class="btn btn-secondary" disabled>ğŸ—‘ï¸ Limpiar SelecciÃ³n</button>
                <button id="analyzeBtn" class="btn btn-success" disabled>ğŸ” Analizar</button>
            </div>

            <div class="info-panel">
                <p><strong>Instrucciones:</strong></p>
                <ol>
                    <li>Reproduce el video y pausa en el momento que desees analizar</li>
                    <li>Haz clic en "Capturar Frame" para tomar una instantÃ¡nea</li>
                    <li>Dibuja un rectÃ¡ngulo sobre la regiÃ³n que quieres analizar (opcional)</li>
                    <li>Haz clic en "Analizar" para ejecutar los agentes</li>
                </ol>
                <p id="selectionInfo" class="selection-info"></p>
            </div>
        </section>

        <!-- Analysis Section -->
        <section class="analysis-section" id="analysisSection" style="display: none;">
            <h2>ğŸ“Š 3. Resultados del AnÃ¡lisis</h2>
            
            <div class="loading-indicator" id="loadingIndicator" style="display: none;">
                <div class="spinner"></div>
                <p>ğŸ¤– Ejecutando agentes de anÃ¡lisis...</p>
                <p class="loading-subtext">Vision Agent â†’ OCR Agent â†’ Detection Agent</p>
            </div>

            <div class="results-container" id="resultsContainer" style="display: none;">
                <!-- Tabs -->
                <div class="tabs">
                    <button class="tab active" data-tab="text">ğŸ“„ Reporte Texto</button>
                    <button class="tab" data-tab="json">ğŸ“‹ Datos JSON</button>
                    <button class="tab" data-tab="preview">ğŸ–¼ï¸ Preview</button>
                </div>

                <!-- Tab Contents -->
                <div class="tab-content active" id="textTab">
                    <pre id="textResults" class="results-text"></pre>
                </div>

                <div class="tab-content" id="jsonTab">
                    <pre id="jsonResults" class="results-json"></pre>
                </div>

                <div class="tab-content" id="previewTab">
                    <canvas id="previewCanvas"></canvas>
                </div>

                <div class="actions">
                    <button id="copyJsonBtn" class="btn btn-secondary">ğŸ“‹ Copiar JSON</button>
                    <button id="downloadReportBtn" class="btn btn-secondary">ğŸ’¾ Descargar Reporte</button>
                    <button id="newAnalysisBtn" class="btn btn-primary">ğŸ”„ Nuevo AnÃ¡lisis</button>
                </div>

                <!-- Chat Section for Conversational Analysis -->
                <div class="chat-section">
                    <h3>ğŸ’¬ Chat con el Agente - AnÃ¡lisis Conversacional</h3>
                    <div id="chatMessages"></div>
                    <div class="chat-input-container">
                        <textarea id="chatInput" placeholder="Pregunta sobre la imagen analizada..."></textarea>
                        <button id="sendChat" class="btn" disabled>Enviar</button>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Scripts -->
    <script src="static/js/video-player.js"></script>
    <script src="static/js/roi-selector.js"></script>
    <script src="static/js/api-client.js"></script>
</body>
</html>

